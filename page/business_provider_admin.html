<!-- 页面外套 -->
<div class="page-wrapper" id="business_provider_admin">

    <!-- 数据网格 -->
    <div class="datagrid datagrid-striped" id="business_provider_admin_datagrid">

        <!-- 工具条组 -->
        <div class="tool-group">
            <div class="tool-search">
                <div class="im-label">
                    <div class="input-group">
                        <select class="form-control" id="business_provider_admin_tool_keys">
                            <option value="1">姓名</option>
                            <option value="2">手机</option>
                            <option value="3">公司</option>
                        </select>
                        <span class="input-group-addon fix-border fix-padding"></span>
                        <input type="text" class="form-control" id="business_provider_admin_tool_search">
                    </div>
                </div>
                <label>
                    <span>级别：</span>
                    <select class="form-control" id="business_provider_admin_tool_select1">
                        <option value="0">全部</option>
                        <option value="1">A</option>
                        <option value="2">B</option>
                        <option value="3">C</option>
                        <option value="4">D</option>
                        <option value="5">E</option>
                    </select>
                </label>
                <label><button class="btn btn-primary" id="business_provider_admin_search_btn"><i class="icon icon-search"></i> 搜索</button></label>
                <div class="clearfix"></div>
            </div>
            <div class="tool-deal">
            	<label><button class="btn btn-primary" id="business_provider_admin_turn_btn"> <i class="icon icon-exchange"></i> 转移</button></label>
                <label><button class="btn btn-primary" id="business_provider_admin_aban_btn"> <i class="icon icon-inbox"></i>    放弃</button></label>
                <label><button class="btn btn-primary" id="business_provider_admin_dele_btn"> <i class="icon icon-trash"></i>    删除</button></label>
                <div class="clearfix"></div>
            </div>
        </div>
        <!-- tool-group -->

        <div class="datagrid-container"></div>
        <ul class="pager btn-mini" data-elements="prev,pages,next"></ul>
    </div>
    <!-- datagrid -->

    <!-- 批量转移盒子 -->
    <div class="modal modal-for-page fade" aria-hidden="false" id="business_provider_admin_turn_box">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">关闭</span></button>
                    <h4 class="modal-title">批量转移</h4>
                </div>
                <div class="modal-body">
                    <form class="container form-horizontal">
                        <div class="form-group">
                            <label class="col-sm-2 required" for="business_provider_admin_turn_provider">待转信息员</label>
                            <div class="col-sm-8"><input type="text" class="form-control" id="business_provider_admin_turn_provider" readonly></div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 required" for="business_provider_admin_turn_salesman">目标业务员</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control common_person_btn" id="business_provider_admin_turn_salesman" dataId="" readonly>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-2 required" style="text-align:right">
                                <input type="checkbox" id="business_provider_admin_turn_checkbox">
                            </div>
                            <label class="col-sm-8" for="business_provider_admin_turn_checkbox" style="text-align:left">
                                是否同意“待转信息员”下未隶属的“在跟踪”和“在谈”客户
                            </label>                            
                        </div>                        
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" id="business_provider_admin_turn_submit">提交</button>
                </div>                
            </div>
        </div>
    </div>
    <!-- business_provider_admin_turn_box -->

    <!-- 批量放弃盒子 -->
    <div class="modal modal-for-page fade" aria-hidden="false" id="business_provider_admin_aban_box">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">关闭</span></button>
                    <h4 class="modal-title">批量放弃</h4>
                </div>
                <div class="modal-body">
                    <form class="container form-horizontal">
                        <div class="form-group">
                            <label class="col-sm-2 required" for="business_provider_admin_aban_type">放弃理由</label>
                            <div class="col-sm-8">
                                <select class="form-control" id="business_provider_admin_aban_type">
                                    <option value="1">有价值</option>
                                    <option value="2">无价值</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 required" for="business_provider_admin_aban_text">理由详情</label>
                            <div class="col-sm-8">
                                <textarea class="form-control" id="business_provider_admin_aban_text"></textarea>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-danger" id="business_provider_admin_aban_submit">提交</button>
                </div>                
            </div>
        </div>
    </div>
    <!-- business_provider_admin_aban_box -->

    <!-- 批量删除盒子 -->
    <div class="modal modal-for-page fade" aria-hidden="false" id="business_provider_admin_dele_box">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">关闭</span></button>
                    <h4 class="modal-title">批量删除</h4>
                </div>
                <div class="modal-body">
                    <div class="container">
                        <p class="text-danger"><i class="icon icon-warning-sign"></i> 是否删除？</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-danger" id="business_provider_admin_dele_submit">提交</button>
                </div>                
            </div>
        </div>
    </div>
    <!-- business_provider_admin_dele_box -->

    <!-- 信息员查看盒子 -->
    <div class="modal modal-for-page fade" aria-hidden="false" id="business_provider_admin_show_box">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content">
                <div class="modal-header">
                    <button class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">关闭</span></button>
                    <h4 class="modal-title">信息员查看</h4>
                </div>
                <div class="modal-body modal-scroll">
                    <div class="container">
                        <!-- 基本信息 -->
                        <table class="table table-bordered" id="business_provider_admin_show_table0">
                            <thead><tr><th colspan="2">基本信息</th></tr></thead>
                            <tbody><!-- JS推进 --></tbody>
                        </table>
                        <!-- 切换面板 -->
                        <ul class="nav nav-tabs">
                            <li class="active"><a data-tab="" href="#business_provider_admin_show_table1">客户记录</a></li>
                            <li><a data-tab="" href="#business_provider_admin_show_table2">信息费记录</a></li>
                            <li><a data-tab="" href="#business_provider_admin_show_table3">提成记录</a></li>
                            <li><a data-tab="" href="#business_provider_admin_show_table4">过程记录</a></li>
                        </ul>
                        <div class="tab-content">
                            <div class="datagrid datagrid-striped tab-pane active" id="business_provider_admin_show_table1">
                                <div class="datagrid-container"></div>
                                <ul class="pager btn-mini" data-elements="prev,pages,next"></ul>
                            </div>
                            <div class="datagrid datagrid-striped tab-pane" id="business_provider_admin_show_table2">
                                <div class="datagrid-container"></div>
                                <ul class="pager btn-mini" data-elements="prev,pages,next"></ul>
                            </div>
                            <div class="datagrid datagrid-striped tab-pane" id="business_provider_admin_show_table3">
                                <div class="datagrid-container"></div>
                                <ul class="pager btn-mini" data-elements="prev,pages,next"></ul>
                            </div>
                            <div class="datagrid datagrid-striped tab-pane" id="business_provider_admin_show_table4">
                                <div class="datagrid-container"></div>
                                <ul class="pager btn-mini" data-elements="prev,pages,next"></ul>
                            </div>                            
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- business_provider_admin_show_box -->

    <!-- 转为客户盒子 -->
    <div class="modal modal-for-page fade" aria-hidden="false" id="business_provider_admin_turn_customer_box">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">关闭</span></button>
                    <h4 class="modal-title">转为客户</h4>
                </div>
                <div class="modal-body">
                    <p>您确定要转为客户吗？</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" id="business_provider_admin_turn_customer_submit">提交</button>
                </div>
            </div>
        </div>
    </div>
    <!-- business_provider_admin_turn_customer_box -->
 
    <!-- 日志查看盒子 -->
    <div class="modal modal-for-page fade" aria-hidden="false" id="business_provider_admin_logShow_box">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">关闭</span></button>
                    <h4 class="modal-title">日志查看</h4>
                </div>
                <div class="modal-body modal-scroll">
                    <div class="container comments">
                        <!-- JS推进 -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- business_provider_admin_logShow_box -->

    <!-- 人员选择盒子 -->
    <div class="modal modal-for-page fade" aria-hidden="false" id="business_provider_admin_salesman_box">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">关闭</span></button>
                    <h4 class="modal-title">人员选择</h4>
                </div>
                <div class="modal-body no-padding">

                    <!-- 数据网格 -->
                    <div class="datagrid datagrid-striped" id="business_provider_admin_salesman_datagrid">

                        <!-- 工具条组 -->
                        <div class="tool-group no-padding">
                            <div class="tool-deal" style="border:none;">
                                <label>
                                    <span>姓名：</span>
                                    <input type="text" class="form-control" id="business_provider_admin_salesman_user">
                                </label>
                                <label>
                                    <span>部门：</span>
                                    <select class="form-control" id="business_provider_admin_salesman_depart"><!-- JS推进 --></select>
                                </label>
                                <label><button class="btn btn-primary" id="business_provider_admin_salesman_search_btn">搜索</button></label>
                                <div class="clearfix"></div>
                            </div>
                        </div>
                        <!-- tool-group -->
                        <div class="datagrid-container"></div>
                        <ul class="pager btn-mini" data-elements="prev,pages,next"></ul>
                    </div>
                    <!-- datagrid -->

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" id="business_provider_admin_salesman_submit">提交</button>
                </div>
            </div>
        </div>
    </div>
    <!-- business_provider_admin_salesman_box -->

</div>
<!-- page-wrapper -->
<script>
$(function(){
    
    //变量声明-----------------------------------------------------------------------------------------------
    var 
    business_provider_admin                     = $("#business_provider_admin"),                        //页面ID
    business_provider_admin_datagrid            = $("#business_provider_admin_datagrid"),               //数据表格
    //搜索
    business_provider_admin_tool_keys           = $("#business_provider_admin_tool_keys"),              //搜索类别
    business_provider_admin_tool_search         = $("#business_provider_admin_tool_search"),            //搜索字段
    business_provider_admin_tool_select1        = $("#business_provider_admin_tool_select1"),           //下拉选择1
    business_provider_admin_search_btn          = $("#business_provider_admin_search_btn"),             //搜索按钮
    //批量转移
    business_provider_admin_turn_box 	        = $("#business_provider_admin_turn_box"), 			    //转移盒子
    business_provider_admin_turn_btn            = $("#business_provider_admin_turn_btn"),               //转移按钮
    business_provider_admin_turn_submit         = $("#business_provider_admin_turn_submit"),            //转移按钮
    business_provider_admin_turn_provider       = $("#business_provider_admin_turn_provider"),          //信息员
    business_provider_admin_turn_salesman       = $("#business_provider_admin_turn_salesman"),          //业务员
    business_provider_admin_turn_checkbox       = $("#business_provider_admin_turn_checkbox"),          //复选框
    //批量放弃
    business_provider_admin_aban_box            = $("#business_provider_admin_aban_box"),               //放弃盒子
    business_provider_admin_aban_btn            = $("#business_provider_admin_aban_btn"),               //放弃按钮
    business_provider_admin_aban_submit         = $("#business_provider_admin_aban_submit"),            //放弃按钮
    business_provider_admin_aban_type           = $("#business_provider_admin_aban_type"),              //放弃类别
    business_provider_admin_aban_text           = $("#business_provider_admin_aban_text"),              //放弃文本
    //批量删除
    business_provider_admin_dele_box            = $("#business_provider_admin_dele_box"),               //删除盒子
    business_provider_admin_dele_btn            = $("#business_provider_admin_dele_btn"),               //删除按钮
    business_provider_admin_dele_submit         = $("#business_provider_admin_dele_submit"),            //删除按钮
    //查看信息员
    business_provider_admin_show_box            = $("#business_provider_admin_show_box"),               //查看盒子
    business_provider_admin_show_table0         = $("#business_provider_admin_show_table0"),            //切换表格1
    business_provider_admin_show_table1         = $("#business_provider_admin_show_table1"),            //切换表格2
    business_provider_admin_show_table2         = $("#business_provider_admin_show_table2"),            //切换表格3
    business_provider_admin_show_table3         = $("#business_provider_admin_show_table3"),            //切换表格4
    business_provider_admin_show_table4         = $("#business_provider_admin_show_table4"),            //切换表格5
 	//转为客户
    business_provider_admin_turn_customer_box   = $("#business_provider_admin_turn_customer_box"),      //放弃盒子
    business_provider_admin_turn_customer_submit= $("#business_provider_admin_turn_customer_submit"),   //放弃提交
    //跟踪日志
    business_provider_admin_logShow_box         = $("#business_provider_admin_logShow_box"),            //查看盒子
    //人员选择
    business_provider_admin_salesman_box        = $("#business_provider_admin_salesman_box"),           //选择盒子
    business_provider_admin_salesman_datagrid   = $("#business_provider_admin_salesman_datagrid"),      //数据表格
    business_provider_admin_salesman_user       = $("#business_provider_admin_salesman_user"),          //姓名字段
    business_provider_admin_salesman_depart     = $("#business_provider_admin_salesman_depart"),        //部门选择
    business_provider_admin_salesman_search_btn = $("#business_provider_admin_salesman_search_btn"),    //搜索按钮
    business_provider_admin_salesman_submit     = $("#business_provider_admin_salesman_submit");        //提交按钮

    //接口对象-----------------------------------------------------------------------------------------------
    if( window.STATE == "local" ){

        //本地接口
        var business_provider_admin_api = {
            datagrid            : LOCAL + "Test/test_datagrid.json",            //数据表格
            datagrid_salesman   : LOCAL + "Test/test_datagrid.json",            //数据表格2
            datagrid_table1     : LOCAL + "Test/test_datagrid.json",            //查看表格1
            datagrid_table2     : LOCAL + "Test/test_datagrid.json",            //查看表格2
            datagrid_table3     : LOCAL + "Test/test_datagrid.json",            //查看表格3
            datagrid_table4     : LOCAL + "Test/test_datagrid.json",            //查看表格4
            select              : LOCAL + "Test/test_select.json",              //下拉选择
            modal_show          : LOCAL + "Test/Business/provider_edit.json",   //修改盒子
            topic               : LOCAL + "Test/Business/provider_topic.json",  //日志查看
        }

    } else if ( window.STATE == "route" ){

        //远程接口
        var business_provider_admin_api = {
            datagrid            : LOCAL + "Test/test_datagrid.json",            //数据表格
            datagrid_salesman   : LOCAL + "Test/test_datagrid.json",            //数据表格2
            datagrid_table1     : LOCAL + "Test/test_datagrid.json",            //查看表格1
            datagrid_table2     : LOCAL + "Test/test_datagrid.json",            //查看表格2
            datagrid_table3     : LOCAL + "Test/test_datagrid.json",            //查看表格3
            datagrid_table4     : LOCAL + "Test/test_datagrid.json",            //查看表格4
            select              : LOCAL + "Test/test_select.json",              //下拉选择
            modal_show          : LOCAL + "Test/Business/provider_edit.json",   //修改盒子
            topic               : LOCAL + "Test/Business/provider_topic.json",  //日志查看
        }

    }

    //数据表格-----------------------------------------------------------------------------------------------
    business_provider_admin_datagrid.datagrid({
        height      : zui_datagrid_height(business_provider_admin_datagrid),
        sortable    : false,
        cache       : false,
        showRowIndex: true,
		checkable   : true,
		checkByClickRow:false,
		selectable  : false,
        configs     : {
            R0:{className:"text-center"},
            C1:{className:"cell-hidden"}
        },
        states      : {
            pager           : {
                page        : 1,
                recPerPage  : window.REC_PER_PAGE,
            }
        },
        dataSource : {
            cols   : [
                {name:"id",  label:"ID",  width:49},
                {name:"name",label:"姓名",width:80,html:true,
                    valueOperator : {
                        getter : function(dataValue,cell){
                            return `<a class="business_provider_admin_show_btn" rowIndex="${cell.rowIndex}">${dataValue}</a>`;
                        }
                    }
                },
                {name:"text8",  label:"公司名称",    width:150},
                {name:"text5",  label:"工作性质",    width:100},
                {name:"text5",  label:"级别",        width:100},
                {name:"name",   label:"业务员",      width:100},
                {name:"state",  label:"剩余回访天数",width:100},
                {name:"log",    label:"跟踪日志",    width:80,
                    html:true,
                    valueOperator : {
                        getter : function(dataValue,cell){
                            return `<a class="business_provider_admin_logShow_btn" rowIndex="${cell.rowIndex}">查看</a>`;
                        }
                    }
                },
                {name:"operate",  label:"操作",width:150,
                    html:true,
                    valueOperator : {
                        getter : function(dataValue,cell){
                            return `<a class="business_provider_admin_turn_customer_btn" rowIndex="${cell.rowIndex}">转为客户</a>`;
                        }
                    }
                }                
            ],
            remote : function(){
                return {
                    url     : business_provider_admin_api.datagrid,
                    type    : "POST",
                    dataType: "json",
                }
            }
        }
    });

    //查看盒子-切换表格----------------------------------------------------------------------------------------
    //客户记录
    business_provider_admin_show_table1.datagrid({
        height      : "page",
        sortable    : false,
        cache       : false,
        showRowIndex: true,
        configs     : {
            R0:{className:"text-center"},
            C1:{className:"cell-hidden"}
        },
        states      : {
            pager           : {
                page        : 1,
                recPerPage  : window.REC_PER_PAGE,
            }
        },
        dataSource : {
            cols   : [
                {name:"id",     label:"ID",         width:49 },
                {name:"text4",  label:"项目编号",   width:80 },
                {name:"text8",  label:"项目名称",   width:130},
                {name:"name",   label:"联系人",     width:80 },
                {name:"tel",    label:"联系手机",   width:100},
                {name:"text2",  label:"面积",       width:80 },
                {name:"text8",  label:"项目地址",   width:130},
                {name:"name",   label:"业务员",     width:80 },
                {name:"name",   label:"设计师",     width:80 },
                {name:"text1",  label:"流程状态",   width:80 },
            ],
            remote : function(){
                return {
                    url     : business_provider_admin_api.datagrid_table1,
                    type    : "POST",
                    dataType: "json",
                }
            }
        }
    });
    //信息费记录
    business_provider_admin_show_table2.datagrid({
        height      : "page",
        sortable    : false,
        cache       : false,
        showRowIndex: true,
        configs     : {
            R0:{className:"text-center"},
            C1:{className:"cell-hidden"}
        },
        states      : {
            pager           : {
                page        : 1,
                recPerPage  : window.REC_PER_PAGE,
            }
        },
        dataSource : {
            cols   : [
                {name:"id",      label:"ID",      width:49 },
                {name:"text4",   label:"项目编号",width:80 },
                {name:"name",    label:"客户名称",width:80 },
                {name:"name",    label:"业务员",  width:80 },
                {name:"name",    label:"设计师",  width:80 },
                {name:"date",    label:"申请时间",width:100},
                {name:"username",label:"申请金额",width:80 },
                {name:"state",   label:"申请状态",width:80 },
            ],
            remote : function(){
                return {
                    url     : business_provider_admin_api.datagrid_table2,
                    type    : "POST",
                    dataType: "json",
                }
            }
        }
    });
    //提成记录
    business_provider_admin_show_table3.datagrid({
        height      : "page",
        sortable    : false,
        cache       : false,
        showRowIndex: true,
        configs     : {
            R0:{className:"text-center"},
            C1:{className:"cell-hidden"}
        },
        states      : {
            pager           : {
                page        : 1,
                recPerPage  : window.REC_PER_PAGE,
            }
        },
        dataSource : {
            cols   : [
                {name:"id",      label:"ID",        width:49 },
                {name:"text4",   label:"项目编号",  width:80 },
                {name:"text8",   label:"项目名称",  width:130},
                {name:"name",    label:"业务员",    width:80 },
                {name:"name",    label:"设计师",    width:80 },
                {name:"text4",   label:"合同总金额",width:90 },
                {name:"date",    label:"申请时间",  width:100},
                {name:"state",   label:"申请提点",  width:80 },
                {name:"username",label:"应发提成",  width:80 },
                {name:"username",label:"实发提成",  width:80 },
                {name:"state",   label:"申请状态",  width:80 },
            ],
            remote : function(){
                return {
                    url     : business_provider_admin_api.datagrid_table3,
                    type    : "POST",
                    dataType: "json",
                }
            }
        }
    });
    //过程记录
    business_provider_admin_show_table4.datagrid({
        height      : "page",
        sortable    : false,
        cache       : false,
        showRowIndex: true,
        configs     : {
            R0:{className:"text-center"},
            C1:{className:"cell-hidden"}
        },
        states      : {
            pager           : {
                page        : 1,
                recPerPage  : window.REC_PER_PAGE,
            }
        },
        dataSource : {
            cols   : [
                {name:"id",     label:"ID",        width:49 },
                {name:"name",   label:"操作人",    width:80 },
                {name:"date",   label:"操作时间",  width:140},
                {name:"tex10",  label:"过程说明",  width:400},
            ],
            remote : function(){
                return {
                    url     : business_provider_admin_api.datagrid_table4,
                    type    : "POST",
                    dataType: "json",
                }
            }
        }
    });

    //变量声明-----------------------------------------------------------------------------------------------
    var
    business_provider_admin_datagrid_obj     = business_provider_admin_datagrid.data("zui.datagrid"),       //表格对象
    business_provider_admin_show_table1_obj  = business_provider_admin_show_table1.data("zui.datagrid"),    //查看表格1
    business_provider_admin_show_table2_obj  = business_provider_admin_show_table2.data("zui.datagrid"),    //查看表格2
    business_provider_admin_show_table3_obj  = business_provider_admin_show_table3.data("zui.datagrid"),    //查看表格3
    business_provider_admin_show_table4_obj  = business_provider_admin_show_table4.data("zui.datagrid"),    //查看表格4
    business_provider_admin_turn_customer_btn= ".business_provider_admin_turn_customer_btn",  		        //转为客户
    business_provider_admin_show_btn         = ".business_provider_admin_show_btn",                         //查看按钮
    business_provider_admin_logShow_btn      = ".business_provider_admin_logShow_btn";                      //日志查看
 
    //下拉选项-----------------------------------------------------------------------------------------------
    $.ajax({
        url     : business_provider_admin_api.select,
        type    : "post",
        dataType: "json",
        data    : {},
        success : function(data){
            if( data.status>0 ){
                var data = data.data;
                var option = "<option value='0'>全部</option>";
                for(var i=0;i<data.length;i++){
                    option += "<option value='"+data[i].id+"'>"+data[i].name+"</option>"
                }
                business_provider_admin_salesman_depart.html(option);                                   //人员选择
            }
        }
    });

    //搜索按钮-----------------------------------------------------------------------------------------------
    business_provider_admin_search_btn.click(function(){

        //字段整理
        var keyword
        = "?sid="    + business_provider_admin_tool_keys.val()
        + "&search=" + business_provider_admin_tool_search.val()
        + "&level="  + business_provider_admin_tool_select1.val();

        //GET提交
        zui_datagrid_render(business_provider_admin_datagrid_obj,business_provider_admin_api.datagrid+keyword);

    });

    //查看按钮-----------------------------------------------------------------------------------------------
    $(document).on("click",business_provider_admin_show_btn,function(){ 

        //数据ID
        var data_id  = zui_datagrid_get_id($(this).attr("rowIndex"));

        //远程提交
        $.ajax({
            url     : business_provider_admin_api.modal_show,
            type    : "post",
            dataType: "json",
            data    : { id:data_id },
            success : function(data){
                if( data.status>0 ){

                    //查看模板
                    var data = data.data;
                    var temp = `
                        <tr><td style="width:100px;">姓名</td><td>${data.user}</td></tr>
                        <tr><td>公司名称  </td><td>${data.comp}     </td></tr>
                        <tr><td>级别      </td><td>${data.levelname}</td></tr>
                        <tr><td>工作性质  </td><td>${data.natuname} </td></tr>
                        <tr><td>服务区域  </td><td>${data.area}     </td></tr>
                        <tr><td>银行卡号  </td><td>${data.bankcode} </td></tr>
                        <tr><td>开户人    </td><td>${data.bankuser} </td></tr>
                        <tr><td>开户行    </td><td>${data.bankname} </td></tr>
                        <tr><td>生日      </td><td>${data.birt}     </td></tr>
                        <tr><td>身份证号  </td><td>${data.card}     </td></tr>
                        <tr><td>备注信息  </td><td>${data.text}     </td></tr>
                    `;

                    //模板填充
                    business_provider_admin_show_table0.find("tbody").html(temp);

                    //列表刷新
                    zui_datagrid_render(business_provider_admin_show_table1_obj,business_provider_admin_api.datagrid_table1+"?id="+data_id);
                    zui_datagrid_render(business_provider_admin_show_table2_obj,business_provider_admin_api.datagrid_table2+"?id="+data_id);
                    zui_datagrid_render(business_provider_admin_show_table3_obj,business_provider_admin_api.datagrid_table3+"?id="+data_id);
                    zui_datagrid_render(business_provider_admin_show_table4_obj,business_provider_admin_api.datagrid_table4+"?id="+data_id);

                    //盒子显示
                    business_provider_admin_show_box.modal("show");
                    
                } else {
                    um_tip(data.message,"1500","text-danger");
                }
            }
        });

    }); 

    //批量转移按钮-----------------------------------------------------------------------------------------------
    business_provider_admin_turn_btn.click(function(){
        
        //数据复原
        business_provider_admin_turn_salesman.attr("dataId","");
        common_form_reset();

        //批量取值
        var data_arr = business_provider_admin_datagrid_obj.getCheckItems().filter(function(e){return e});
        if( data_arr.length>0 ){
            
            //ID获取
            var data_id = [];
            for(var i=0;i<data_arr.length;i++){
                data_id.push(data_arr[i].id);
            }

            //姓名获取
            var data_user = [];
            for(var x=0;x<data_id.length;x++){
                data_user.push(data_arr[x].name);
            }

            //数据赋值
            business_provider_admin_turn_provider.val(data_user.join(","));
            business_provider_admin_turn_submit.attr("dataId",data_id.join(","));

            //面板显示
            business_provider_admin_turn_box.modal("show");

        } else {
            um_tip("至少选择一条数据","1000","text-danger");
        }

    });
    //批量转移提交
    business_provider_admin_turn_submit.click(function(){

        //ID取值
        var data_id = $(this).attr("dataId");

        //远程提交
        $.ajax({
            url     : API.test_response,
            type    : "post",
            dataType: "json",
            data    : { 
                id      : data_id,
                salesman: business_provider_admin_turn_salesman.attr("dataId"),
                checkbox: business_provider_admin_turn_checkbox.is(":checked"),
            },
            success : function(data){
                if( data.status>0 ){
                    um_tip(data.message);
                    zui_datagrid_reset(business_provider_admin_datagrid_obj,business_provider_admin_api.datagrid,"clear");
                } else {
                    um_tip(data.message,"1500","text-danger");
                }
            }
        });

    });

    //批量放弃按钮-----------------------------------------------------------------------------------------------
    business_provider_admin_aban_btn.click(function(){

        //数据复原
        common_form_reset();

        //批量取值
        var data_arr = business_provider_admin_datagrid_obj.getCheckItems().filter(function(e){return e});
        if( data_arr.length>0 ){
            
            //ID获取
            var data_id = [];
            for(var i=0;i<data_arr.length;i++){
                data_id.push(data_arr[i].id);
            }

            //数据赋值
            business_provider_admin_aban_submit.attr("dataId",data_id.join(","));
     
            //面板显示
            business_provider_admin_aban_box.modal("show");

        } else {
            um_tip("至少选择一条数据","1000","text-danger");
        }

    });
    //批量放弃提交
    business_provider_admin_aban_submit.click(function(){

        //ID取值
        var data_id = $(this).attr("dataId");

        //远程提交
        $.ajax({
            url     : API.test_response,
            type    : "post",
            dataType: "json",
            data    : { 
                id   : data_id,
                type : business_provider_admin_aban_type.val(),
                text : business_provider_admin_aban_text.val(),
            },
            success : function(data){
                if( data.status>0 ){
                    um_tip(data.message);
                    zui_datagrid_reset(business_provider_admin_datagrid_obj,business_provider_admin_api.datagrid,"clear");
                } else {
                    um_tip(data.message,"1500","text-danger");
                }
            }
        });

    });

    //批量删除按钮-----------------------------------------------------------------------------------------------
    business_provider_admin_dele_btn.click(function(){
 
        //数据复原
        common_form_reset();

        //批量取值
        var data_arr = business_provider_admin_datagrid_obj.getCheckItems().filter(function(e){return e});
        if( data_arr.length>0 ){
            
            //ID获取
            var data_id = [];
            for(var i=0;i<data_arr.length;i++){
                data_id.push(data_arr[i].id);
            }

            //数据赋值
            business_provider_admin_dele_submit.attr("dataId",data_id.join(","));
     
            //面板显示
            business_provider_admin_dele_box.modal("show");

        } else {
            um_tip("至少选择一条数据","1000","text-danger");
        }
 
    });
    //批量删除提交
    business_provider_admin_dele_submit.click(function(){

        //ID取值
        var data_id = $(this).attr("dataId");

        //远程提交
        $.ajax({
            url     : API.test_response,
            type    : "post",
            dataType: "json",
            data    : { id:data_id },
            success : function(data){
                if( data.status>0 ){
                    um_tip(data.message);
                    zui_datagrid_reset(business_provider_admin_datagrid_obj,business_provider_admin_api.datagrid,"clear");
                } else {
                    um_tip(data.message,"1500","text-danger");
                }
            }
        });

    });

    //日志查看-----------------------------------------------------------------------------------------------
    $(document).on("click",business_provider_admin_logShow_btn,function(){

        //数据复原
        common_topic_answer_reset();

        //ID取值
        var data_id = $(this).attr("rowIndex");

        //远程提交
        $.ajax({
            url     : business_provider_admin_api.topic,
            type    : "post",
            dataType: "json",        
            data    : {
                id : data_id,
            },
            success : function(data){

                if( data.status>0 ){

                    //变量赋值
                    var data = data.data;
                    var temp = "";

                    //一级话题
                    for(var i=0;i<data.length;i++){
                        temp+=`
                            <div class="comments-list">
                                <div class="comment">
                                    <div class="avatar text-center">
                                        <i class="icon-user icon-2x text-primary"></i>
                                        <div class="small text-primary">${data[i].user}</div>
                                    </div>
                                    <div class="content">
                                        <div class="pull-right text-muted">${data[i].date}</div>
                                        <div class="text">${data[i].text}</div>
                                        <div class="actions common_topic_imgs_wrap">
                                            <a class="common_topic_imgs_btn">图片[${data[i].imgs.length}]</a>
                                            <div class="common_topic_imgs_box hide">`;

                        //图片循环
                        for(var m=0;m<data[i].imgs.length;m++){
                            temp+=`<a class="ov1" target="_blank" href=${FILE_PATH}${data[i].imgs[m].path}>${data[i].imgs[m].name}</a>`;
                        }

                        //标签收尾
                        temp+=`</div></div></div>`;

                        //评论嵌套
                        for(var j=0;j<data[i].childTopic.length;j++){
                            temp+=`
                                <div class="comments-list">
                                    <div class="comment">
                                        <div class="content">
                                            <div class="pull-right text-muted">10-20 11:00</div>
                                            <div><b>${data[i].childTopic[j].user}</b></div>
                                            <div class="text">${data[i].childTopic[j].text}</div>
                                        </div>
                                    </div>
                                </div>`;
                        }

                        //标签收尾
                        temp+=`
                        <div class="comments-list comments-list-for-answer">
                            <div class="actions">
                                <a class="common_topic_answer_btn">回复</a>
                                <div class="hide common_topic_answer_text_wrap">
                                    <textarea class="form-control common_topic_answer_text"></textarea>
                                    <button type="button" class="pull-right btn btn-mini btn-primary business_provider_admin_logShow_submit" data-tid="${data[i].id}" style="margin-top:5px;">提交</button>
                                    <div class="clearfix"></div>
                                </div>
                            </div>
                        </div>
                        </div></div>`;
                    }

                    //文本推进
                    business_provider_admin_logShow_box.find(".comments").html(temp);
                    
                    //ID赋值
                    business_provider_admin_logShow_box.attr("rowIndex",data_id);
                    
                    //面板显示
                    business_provider_admin_logShow_box.modal("show");

                } else {
                    um_tip(data.message,"1500","text-danger");
                }
            }
        });

    });
    //日志回复
    $(document).on("click",".business_provider_admin_logShow_submit",function(){
        //变量声明
        var data_id = business_provider_admin_logShow_box.attr("rowIndex");
        var tid     = $(this).attr("data-tid");
        var text    = $(this).parent().find(".common_topic_answer_text").val();
        //远程提交
        $.ajax({
            url     : API.test_response,
            type    : "post",
            dataType: "json",
            data    : { 
                id  : data_id,
                tid : tid,
                text: text
            },
            success : function(data){
                if( data.status>0 ){
                    um_tip(data.message);
                    zui_datagrid_reset(business_provider_admin_datagrid_obj,business_provider_admin_api.datagrid);
                } else {
                    um_tip(data.message,"1500","text-danger");
                }
            }
        });
    });
    
    //转为客户按钮-----------------------------------------------------------------------------------------------
    $(document).on("click",business_provider_admin_turn_customer_btn,function(){

        //数据ID
        var data_id = zui_datagrid_get_id($(this).attr("rowIndex"));

        //其他操作
        business_provider_admin_turn_customer_submit.attr("dataId",data_id);                                //ID传值
        business_provider_admin_turn_customer_box.modal("show");                                            //面板显示

    });
    //转为客户提交
    business_provider_admin_turn_customer_submit.click(function(){

        //数据ID
        var data_id = $(this).attr("dataId");

        //远程提交
        $.ajax({
            url     : API.test_response,
            type    : "post",
            dataType: "json",
            data    : { id:data_id },
            success : function(data){
                if( data.status>0 ){
                    um_tip(data.message);
                    zui_datagrid_reset(business_provider_admin_datagrid_obj,business_provider_admin_api.datagrid);
                } else {
                    um_tip(data.message,"1500","text-danger");
                }
            }
        });

    });

    //人员选择-----------------------------------------------------------------------------------------------
    //数据列表
    business_provider_admin_salesman_datagrid.datagrid({
        height      : 400,
        sortable    : false,
        cache       : false,
        showRowIndex: true,
        checkable   : true,
        selectable  : false,
        configs     : {
            R0:{className:"text-center"},
            C1:{className:"cell-hidden"}
        },
        states      : {
            pager           : {
                page        : 1,
                recPerPage  : window.REC_PER_PAGE,
            }
        },
        dataSource : {
            cols   : [
                {name:"id",          label:"ID",  width:1 },
                {name:"name",        label:"姓名",width:80 },
                {name:"departname",  label:"部门",width:100},
                {name:"positionname",label:"职务"}
            ],
            remote : function(){
                return {
                    url     : business_provider_admin_api.datagrid_salesman,
                    type    : "POST",
                    dataType: "json",
                }
            }
        }
    });
    var business_provider_admin_salesman_datagrid_obj = business_provider_admin_salesman_datagrid.data("zui.datagrid");

    //搜索按钮
    business_provider_admin_salesman_search_btn.click(function(){

        //字段整理
        var keyword
        = "?search=" + business_provider_admin_salesman_user.val()
        + "&depart=" + business_provider_admin_salesman_depart.val();

        //GET提交
        zui_datagrid_render(business_provider_admin_salesman_datagrid_obj,business_provider_admin_api.datagrid_salesman+keyword);

    });
    //点击显示
    $(".common_person_btn").click(function(){

        //按钮ID获取
        COMMON_PERSON_BTNID = $(this).attr("id");

        //批量勾选去除
        var data_arr = business_provider_admin_salesman_datagrid_obj.getCheckItems().filter(function(e){return e});
        for(var i=0;i<data_arr.length;i++){
            business_provider_admin_salesman_datagrid_obj.checkRow(i,false);
        }

        //面板显示
        business_provider_admin_salesman_box.modal("show");

    });
    //提交按钮
    business_provider_admin_salesman_submit.click(function(){

        //批量取值
        var data_arr = business_provider_admin_salesman_datagrid_obj.getCheckItems().filter(function(e){return e});
       
        if( data_arr.length==1 ){
            
            //数据赋值
            $("#"+COMMON_PERSON_BTNID).val(data_arr[0].name);
            $("#"+COMMON_PERSON_BTNID).attr("dataId",data_arr[0].id);

            //面板显示
            business_provider_admin_salesman_box.modal("hide");

        } else {
            um_tip("请选择一条数据","1000","text-danger");
        }

    });

});//预加载结尾
</script>