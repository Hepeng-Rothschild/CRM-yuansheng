<!-- 页面外套 -->
<div class="page-wrapper" id="personnel_train_exam">
    
    <!-- 数据网格 -->
    <div class="datagrid datagrid-striped" id="personnel_train_exam_datagrid">
        <div class="tool-group">
            <div class="tool-inline">
                <div class="im-label">
                    <div class="input-group">
                        <select class="form-control" id="personnel_train_exam_tool_keys">
                            <option value="1">姓名</option>
                            <option value="2">工号</option>
                            <option value="3">部门</option>
                        </select>
                        <span class="input-group-addon fix-border fix-padding"></span>
                        <input type="text" class="form-control" id="personnel_train_exam_tool_search">
                    </div>
                </div>
                <label>
                    <span>考试类型：</span>
                    <select class="form-control" id="personnel_train_exam_tool_select1"><!--JS推进--></select>
                </label>
                <div class="im-label">
                    <span>时间：</span>
                    <div class="input-group">
                        <input type="text" class="form-control" id="personnel_train_exam_tool_date1" readonly> 
                        <span class="input-group-addon fix-border fix-padding"></span>
                        <input type="text" class="form-control" id="personnel_train_exam_tool_date2" readonly>
                    </div>
                </div>
                <label><button class="btn btn-primary" id="personnel_train_exam_search_btn"><i class="icon icon-search"></i> 搜索</button></label>
                <div class="clearfix"></div>
                <label><button class="btn btn-primary" id="personnel_train_exam_add_btn"><i class="icon icon-plus"></i> 添加</button></label>
            </div>
        </div>
        <div class="datagrid-container no-border-left"></div>
        <ul class="pager btn-mini" data-elements="prev,pages,next"></ul>
    </div>
    <!-- datagrid -->

    <!-- 添加盒子 -->
    <div class="modal modal-for-page fade" aria-hidden="false" id="personnel_train_exam_add_box">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content">
                <div class="modal-header">
                    <button class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">关闭</span></button>
                    <h4 class="modal-title">添加</h4>
                </div>
                <div class="modal-body modal-scroll">
                    <form class="container">
                        <!-- 试卷信息 -->
                        <blockquote>试卷信息 <span class="small text-red">(以下均为必填项)</span></blockquote>
                        <ul class="form-checker-board">
                            <li class="col-sm-3"><label><span>试卷名称</span><input  id="personnel_train_exam_add_name"  class="form-control" type="text"></label></li>
                            <li class="col-sm-3"><label><span>考试类型</span><select id="personnel_train_exam_add_type"  class="form-control"><!-- JS推进 --></select></label></li>
                            <li class="col-sm-2"><label><span>合格分数</span><input  id="personnel_train_exam_add_score" class="form-control" type="text"></label></li>
                            <li class="col-sm-4"><label><span>考试时间</span>
                                <div class="input-group">
                                    <input id="personnel_train_exam_add_date1" class="form-control" type="text" readonly><span class="input-group-addon fix-border fix-padding"></span>
                                    <input id="personnel_train_exam_add_date2" class="form-control" type="text" readonly>
                                </div>
                            </li>
                        </ul>
                        <div class="clearfix"></div><hr>
                        <!-- 考试人员 -->
                        <blockquote>考试人员 <span class="small text-red">(以下均为必填项)</span></blockquote>
                        <ul class="tree tree-lines tree-chevrons" id="personnel_train_exam_add_tree"></ul>
                        <div class="clearfix"></div><hr>
                        <!-- 试题设置 -->
                        <blockquote>试题设置 <span class="small text-red">(提示：总分为100分，每题分数=100/题数)</span></blockquote>
                        <table class="table table-bordered table-striped" id="personnel_train_exam_add_list"><tr><th style="width:30px;">#</th><th>试题</th></tr></table>
                        <button type="button" class="btn btn-default" id="personnel_train_exam_add_list_btn">添加试题</button>
                        <div class="clearfix"></div><hr>
                        <div class="text-center">
                            <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                            <button type="button" class="btn btn-primary" id="personnel_train_exam_add_submit">保存</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- personnel_train_exam_add_box -->
    
    <!-- 修改盒子 -->
    <div class="modal modal-for-page fade" aria-hidden="false" id="personnel_train_exam_edit_box">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content">
                <div class="modal-header">
                    <button class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">关闭</span></button>
                    <h4 class="modal-title">修改</h4>
                </div>
                <div class="modal-body modal-scroll">
                    <form class="container">
                        <!-- 试卷信息 -->
                        <blockquote>试卷信息 <span class="small text-red">(以下均为必填项)</span></blockquote>
                        <ul class="form-checker-board">
                            <li class="col-sm-3"><label><span>试卷名称</span><input  id="personnel_train_exam_edit_name"  class="form-control" type="text"></label></li>
                            <li class="col-sm-3"><label><span>考试类型</span><select id="personnel_train_exam_edit_type"  class="form-control"><!-- JS推进 --></select></label></li>
                            <li class="col-sm-2"><label><span>合格分数</span><input  id="personnel_train_exam_edit_score" class="form-control" type="text"></label></li>
                            <li class="col-sm-4"><label><span>考试时间</span>
                                <div class="input-group">
                                    <input id="personnel_train_exam_edit_date1" class="form-control" type="text" readonly><span class="input-group-addon fix-border fix-padding"></span>
                                    <input id="personnel_train_exam_edit_date2" class="form-control" type="text" readonly>
                                </div>
                            </li>
                        </ul>
                        <div class="clearfix"></div><hr>
                        <!-- 考试人员 -->
                        <blockquote>考试人员 <span class="small text-red">(以下均为必填项)</span></blockquote>
                        <ul class="tree tree-lines tree-chevrons" id="personnel_train_exam_edit_tree"></ul>
                        <div class="clearfix"></div><hr>
                        <!-- 试题设置 -->
                        <blockquote>试题设置 <span class="small text-red">(提示：总分为100分，每题分数=100/题数)</span></blockquote>
                        <table class="table table-bordered table-striped" id="personnel_train_exam_edit_list"></table>
                        <button type="button" class="btn btn-default" id="personnel_train_exam_edit_list_btn">添加试题</button>
                        <div class="clearfix"></div><hr>
                        <div class="text-center">
                            <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                            <button type="button" class="btn btn-primary" id="personnel_train_exam_edit_submit">保存</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- personnel_train_exam_edit_box -->

    <!-- 删除盒子 -->
    <div class="modal modal-for-page fade" aria-hidden="false" id="personnel_train_exam_dele_box">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">关闭</span></button>
                    <h4 class="modal-title">删除</h4>
                </div>
                <div class="modal-body">
                    <p class="text-danger"><i class="icon icon-warning-sign"></i> 是否删除？</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-danger"  id="personnel_train_exam_dele_submit">提交</button>
                </div>
            </div>
        </div>
    </div>
    <!-- personnel_train_exam_dele_box -->

</div>
<!-- page-wrapper -->

<script>
$(function(){

    //变量声明-----------------------------------------------------------------------------------------------
    var
    personnel_train_exam                    = $("#personnel_train_exam"),                     //页面ID
    personnel_train_exam_datagrid           = $("#personnel_train_exam_datagrid"),            //数据表格
    //搜索
    personnel_train_exam_tool_keys          = $("#personnel_train_exam_tool_keys"),           //搜索类别
    personnel_train_exam_tool_search        = $("#personnel_train_exam_tool_search"),         //搜索字段
    personnel_train_exam_tool_select1       = $("#personnel_train_exam_tool_select1"),        //下拉选择1
    personnel_train_exam_tool_date1         = $("#personnel_train_exam_tool_date1"),          //开始时间
    personnel_train_exam_tool_date2         = $("#personnel_train_exam_tool_date2"),          //结束时间   
    personnel_train_exam_search_btn         = $("#personnel_train_exam_search_btn"),          //搜索按钮
    //添加
    personnel_train_exam_add_btn            = $("#personnel_train_exam_add_btn"),             //添加按钮
    personnel_train_exam_add_box            = $("#personnel_train_exam_add_box"),             //删除盒子
    personnel_train_exam_add_name           = $("#personnel_train_exam_add_name"),            //考试名称
    personnel_train_exam_add_type           = $("#personnel_train_exam_add_type"),            //考试类型
    personnel_train_exam_add_score          = $("#personnel_train_exam_add_score"),           //合格分数
    personnel_train_exam_add_date1          = $("#personnel_train_exam_add_date1"),           //考试时间
    personnel_train_exam_add_date2          = $("#personnel_train_exam_add_date2"),           //考试时间
    personnel_train_exam_add_tree           = $("#personnel_train_exam_add_tree"),            //考试人员
    personnel_train_exam_add_list           = $("#personnel_train_exam_add_list"),            //试题设置
    personnel_train_exam_add_list_btn       = $("#personnel_train_exam_add_list_btn"),        //试题添加
    personnel_train_exam_add_submit         = $("#personnel_train_exam_add_submit"),          //删除提交
    //修改
    personnel_train_exam_edit_box           = $("#personnel_train_exam_edit_box"),            //删除盒子
    personnel_train_exam_edit_name          = $("#personnel_train_exam_edit_name"),           //考试名称
    personnel_train_exam_edit_type          = $("#personnel_train_exam_edit_type"),           //考试类型
    personnel_train_exam_edit_score         = $("#personnel_train_exam_edit_score"),          //合格分数
    personnel_train_exam_edit_date1         = $("#personnel_train_exam_edit_date1"),          //考试时间
    personnel_train_exam_edit_date2         = $("#personnel_train_exam_edit_date2"),          //考试时间
    personnel_train_exam_edit_tree          = $("#personnel_train_exam_edit_tree"),           //考试人员
    personnel_train_exam_edit_list          = $("#personnel_train_exam_edit_list"),           //试题设置
    personnel_train_exam_edit_list_btn      = $("#personnel_train_exam_edit_list_btn"),       //试题添加
    personnel_train_exam_edit_submit        = $("#personnel_train_exam_edit_submit"),         //删除提交
    //删除
    personnel_train_exam_dele_box           = $("#personnel_train_exam_dele_box"),            //删除盒子 
    personnel_train_exam_dele_submit        = $("#personnel_train_exam_dele_submit");         //删除提交

    //接口对象-----------------------------------------------------------------------------------------------
    if( window.STATE == "local" ){

        //本地接口
        var personnel_train_exam_api = {
            datagrid  : LOCAL + "Personnel/Train/exam.json",                                      //数据表格
            tree      : LOCAL + "Personnel/Train/exam_staff.json",                                //考试人员
            select    : LOCAL + "Test/test_select.json",                                          //下拉选择
            edit      : LOCAL + "Personnel/Train/exam_edit.json",                                 //修改数据
        }

    } else if ( window.STATE == "route" ){

        //远程接口
        var personnel_train_exam_api = {
            datagrid  : LOCAL + "Personnel/Train/exam.json",                                      //数据表格
            tree      : LOCAL + "Personnel/Train/exam_staff.json",                                //考试人员
            select    : LOCAL + "Test/test_select.json",                                          //下拉选择
            edit      : LOCAL + "Personnel/Train/exam_edit.json",                                 //修改数据
        }

    }
    
    //数据表格-----------------------------------------------------------------------------------------------
    personnel_train_exam_datagrid.datagrid({
        height      : um_height(personnel_train_exam_datagrid),
        sortable    : false,
        cache       : false,
        showRowIndex: true,
        configs     : {
            R0:{className:"text-center"},
            C1:{className:"cell-hidden"}
        },
        states      : {
            fixedLeftUntil  : 3,
            pager           : {
                page        : 1,
                recPerPage  : window.REC_PER_PAGE,
            }
        },
        dataSource : {
            cols   : [
                {width:9,  name:"id",      label:"ID"      },
                {width:250,name:"subject", label:"考试题目"},
                {width:120,name:"type",    label:"考试类型"},
                {width:120,name:"publish", label:"发布时间"},
                {width:250,name:"examtime",label:"考试时间"},
                {width:80, name:"duration",label:"时长"    },
                {width:80, name:"state",   label:"状态"    },
                {width:180,name:"operate", label:"操作",html:true,
                    valueOperator : {
                        getter : function(dataValue,cell){
                            var temp = `
                                <a rowIndex="${cell.rowIndex}" class="personnel_train_exam_edit_btn">修改</a>
                                <a rowIndex="${cell.rowIndex}" class="personnel_train_exam_publ_btn">发布</a>
                                <a rowIndex="${cell.rowIndex}" class="personnel_train_exam_dele_btn">删除</a>
                            `;
                            return temp;
                        }
                    }
                },
            ],
            remote : function(){
                return {
                    url     : personnel_train_exam_api.datagrid,
                    type    : "POST",
                    dataType: "json",
                }
            }
        }
    });//datagrid()

    //变量声明-----------------------------------------------------------------------------------------------
    var 
    personnel_train_exam_datagrid_obj   = personnel_train_exam_datagrid.data("zui.datagrid"),   //表格对象
    personnel_train_exam_edit_btn       = ".personnel_train_exam_edit_btn",                     //修改按钮
    personnel_train_exam_publ_btn       = ".personnel_train_exam_publ_btn",                     //发布按钮
    personnel_train_exam_dele_btn       = ".personnel_train_exam_dele_btn";                     //删除按钮

    //时间组件-----------------------------------------------------------------------------------------------
    personnel_train_exam_tool_date1.datetimepicker(option_date);
    personnel_train_exam_tool_date2.datetimepicker(option_date);
    personnel_train_exam_add_date1.datetimepicker( option_time);
    personnel_train_exam_add_date2.datetimepicker( option_time);  
    personnel_train_exam_edit_date1.datetimepicker(option_time);
    personnel_train_exam_edit_date2.datetimepicker(option_time);    

    //下拉选项-----------------------------------------------------------------------------------------------
    //考试类型
    $.ajax({
        url     : personnel_train_exam_api.select,
        type    : "post",
        dataType: "json",
        data    : {},
        success : function(data){
            var option = "<option value='0'>全部</option>";
            for(var i=0;i<data.length;i++){
                option += "<option value='"+data[i].id+"'>"+data[i].name+"</option>"
            }
            personnel_train_exam_tool_select1.html(option);
            personnel_train_exam_add_type.html(option);
            personnel_train_exam_edit_type.html(option);            
        }
    });

    //搜索按钮-----------------------------------------------------------------------------------------------
    personnel_train_exam_search_btn.click(function(){

        //字段整理
        var keyword
        = "?sid=" + personnel_train_exam_tool_keys.val()
        + "&search=" + personnel_train_exam_tool_search.val()
        + "&select1="+ personnel_train_exam_tool_select1.val()
        + "&date1="  + personnel_train_exam_tool_date1.val()
        + "&date2="  + personnel_train_exam_tool_date2.val();

        //GET提交
        um_render(personnel_train_exam_datagrid_obj,personnel_train_exam_api.datagrid+keyword);

    });

    //添加按钮-----------------------------------------------------------------------------------------------
    var exam_flag = 0;                                                                      //试题设置
    personnel_train_exam_add_btn.click(function(){
 
        $.ajax({ 
            url     : personnel_train_exam_api.tree,
            type    : "post",
            dataType: "json",
            success : function(data){
                personnel_train_exam_add_tree.tree({
                    //参数配置
                    animate     : false,
                    initialState: "normal",
                    data        : data,
                    itemWrapper : true,
                    itemCreator : function($li,item){
                        $li.append($("<span>",{type:item.type,numb:item.numb}).html(
                        "<i class='icon icon-"+item.icon+"'></i> "+item.title
                        ));
                    }
                });
            }
        });
        personnel_train_exam_add_list.html(""); exam_flag = 0;                              //试题设置复位
        personnel_train_exam_add_box.modal("show");

    });
    //考试人员-节点点击
    personnel_train_exam_add_tree.on("click","span",function(){

        //变量声明
        var empt = "icon-check-empty";
        var chec = "icon-checked";
        var span = $(this);
        var icon = span.find(".icon");
        var type = icon.parent().attr("type");
        var son  = icon.parent().next("ul").find(".icon");
        var dad  = span.parent().parent().siblings("span").find(".icon");
        var bro  = span.parent().parent().find("span");

        //选中影响(父级对子级)
        if( icon.hasClass(empt) ){
            icon.removeClass(empt).addClass(chec);
            if( type=="level1" ){ son.removeClass(empt).addClass(chec); }
        } else {
            icon.removeClass(chec).addClass(empt);
            if( type=="level1" ){ son.removeClass(chec).addClass(empt); }
        } 

        //选中影响(子级对父级)
        var brod = bro.find(".icon-checked").parent();
        if( type=="level2" ){
            if( brod.length==bro.length ){
                dad.removeClass(empt).addClass(chec);
            } else {
                dad.removeClass(chec).addClass(empt);
            }
        }
       
        //结果导出
        var che = personnel_train_exam_add_tree.find("ul .icon-checked");
        var arr = [];
        for( var i=0;i<che.length;i++ ){ arr.push( $(che[i]).parent().attr("numb") ) }
        personnel_train_exam_add_tree.attr("result",arr);

    });
    //试题设置-点击添加
    personnel_train_exam_add_list_btn.click(function(){

        //ID计数
        exam_flag++;

        //试题模板
        var exam_temp = `
            <tr>
                <td class="numb"></td>
                <td>
                    <div class="col-sm-9"><label class="input-group"><span class="input-group-addon">标题</span><input type="text" class="form-control" name="exam_t${exam_flag}"></label></div>
                    <div class="col-sm-3"><label class="input-group"><span class="input-group-addon">正解</span><select class="form-control" name="exam_k${exam_flag}">
                        <option value="1">A</option>
                        <option value="2">B</option>
                        <option value="3">C</option>
                        <option value="4">D</option>
                        </select></label></div>
                    <div class="col-sm-3"><label class="input-group"><span class="input-group-addon"> A  </span><input type="text" class="form-control" name="exam_a${exam_flag}"></label></div>
                    <div class="col-sm-3"><label class="input-group"><span class="input-group-addon"> B  </span><input type="text" class="form-control" name="exam_b${exam_flag}"></label></div>
                    <div class="col-sm-3"><label class="input-group"><span class="input-group-addon"> C  </span><input type="text" class="form-control" name="exam_c${exam_flag}"></label></div>
                    <div class="col-sm-3"><label class="input-group"><span class="input-group-addon"> D  </span><input type="text" class="form-control" name="exam_d${exam_flag}"></label></div>
                    <input type="hidden" name="split">
                </td>
                <td><a>删除</a></td>
            </tr>
        `;

        //试题添加
        personnel_train_exam_add_list.append(exam_temp);

        //行号推进
        var tr = personnel_train_exam_add_list.find("tr");
        for(var i=0;i<tr.length;i++){
            personnel_train_exam_add_list.find("tr").eq(i).find(".numb").text( i+1 );
        }

        //数目限定
        if( i>=50 ){
            um_tip("试题数目已达上限","1000","text-danger");
            personnel_train_exam_add_list_btn.hide();
        }

    });
    //试题设置-点击删除
    personnel_train_exam_add_list.on("click","a",function(){

        //试题删除
        $(this).parent().parent().remove();

        //行号推进
        var tr = personnel_train_exam_add_list.find("tr");
        for(var i=0;i<tr.length;i++){
            personnel_train_exam_add_list.find("tr").eq(i).find(".numb").text( i+1 );
        }

        //限定解除
        if( i<=50 ){
            personnel_train_exam_add_list_btn.show();
        }

    });
    //添加提交
    personnel_train_exam_add_submit.click(function(){
        $.ajax({
            url     : API.test_response,
            type    : "post",
            dataType: "json",
            data    : {
                name  : personnel_train_exam_add_name.val(),
                type  : personnel_train_exam_add_type.val(),
                score : personnel_train_exam_add_score.val(),
                date1 : personnel_train_exam_add_date1.val(),
                date2 : personnel_train_exam_add_date2.val(),
                tree  : personnel_train_exam_add_tree.attr("result"),
                list  : personnel_train_exam_add_box.find("form").serialize()
            },
            success : function(data){
                if( data.code>0 ){
                    um_tip(data.message);
                    um_reset(personnel_train_exam_datagrid_obj,personnel_train_exam_api.datagrid);
                } else {
                    um_tip(data.message,"1500","text-danger");
                }
            }
        });
    });

    //修改按钮-----------------------------------------------------------------------------------------------
    $(document).on("click",personnel_train_exam_edit_btn,function(){

        //数据ID
        var data_id  = cell_value($(this).attr("rowIndex"),1);

        //远程提交
        $.ajax({
            url     : personnel_train_exam_api.edit,
            type    : "post",
            dataType: "json",
            data    : { id : data_id },
            success : function(data){
                if( data.code>0 ){
                   
                    //数据填充
                    personnel_train_exam_edit_name.val(  data.name  );
                    personnel_train_exam_edit_type.val(  data.type  );
                    personnel_train_exam_edit_score.val( data.score );
                    personnel_train_exam_edit_date1.val( data.date1 );
                    personnel_train_exam_edit_date2.val( data.date2 );
                    //考试人员
                    personnel_train_exam_edit_tree.tree({
                        animate     : false,
                        initialState: "normal",
                        data        : data.tree,
                        itemWrapper : true,
                        itemCreator : function($li,item){
                            $li.append($("<span>",{type:item.type,numb:item.numb}).html(
                            "<i class='icon icon-"+item.icon+"'></i> "+item.title
                            ));
                        }
                    });
                    //试题设置
                    //列表推进
                    var edit_temp = "";
                    for( var i=0;i<data.list.length;i++ ){ 
                        edit_temp += `
                        <tr>
                            <td class="numb"></td>
                            <td>
                                <div class="col-sm-9"><label class="input-group"><span class="input-group-addon">标题</span><input type="text" class="form-control" name="exam_t${exam_flag}" value="${Object.values(data.list[i])[0]}"></label></div>
                                <div class="col-sm-3"><label class="input-group"><span class="input-group-addon">正解</span><select class="form-control" name="exam_k${exam_flag}"></select></label></div>
                                <div class="col-sm-3"><label class="input-group"><span class="input-group-addon"> A  </span><input type="text" class="form-control" name="exam_a${exam_flag}" value="${Object.values(data.list[i])[2]}"></label></div>
                                <div class="col-sm-3"><label class="input-group"><span class="input-group-addon"> B  </span><input type="text" class="form-control" name="exam_b${exam_flag}" value="${Object.values(data.list[i])[3]}"></label></div>
                                <div class="col-sm-3"><label class="input-group"><span class="input-group-addon"> C  </span><input type="text" class="form-control" name="exam_c${exam_flag}" value="${Object.values(data.list[i])[4]}"></label></div>
                                <div class="col-sm-3"><label class="input-group"><span class="input-group-addon"> D  </span><input type="text" class="form-control" name="exam_d${exam_flag}" value="${Object.values(data.list[i])[5]}"></label></div>
                                <input type="hidden" name="split">
                            </td>
                            <td><a>删除</a></td>
                        </tr>
                        `;
                    }
                    personnel_train_exam_edit_list.html(edit_temp);
                    //option推进
                    var option = "";
                    for( var i=0;i<data.list.length;i++ ){
                        var selected = Object.values(data.list[i])[1];
                        if( selected==1 ){ option = `<option value="1" selected>A</option><option value="2">B</option><option value="3">C</option><option value="4">D</option>`; }
                        if( selected==2 ){ option = `<option value="1">A</option><option value="2" selected>B</option><option value="3">C</option><option value="4">D</option>`; }
                        if( selected==3 ){ option = `<option value="1">A</option><option value="2">B</option><option value="3" selected>C</option><option value="4">D</option>`; }
                        if( selected==4 ){ option = `<option value="1">A</option><option value="2">B</option><option value="3">C</option><option value="4" selected>D</option>`; }
                        personnel_train_exam_edit_list.find("tr").eq(i).find("select").html(option);
                    }
                    //面板显示
                    personnel_train_exam_edit_box.modal("show");

                } else {
                    um_tip(data.message,"1500","text-danger");
                }
            }
        });


    });

    //发布按钮-----------------------------------------------------------------------------------------------
    $(document).on("click",personnel_train_exam_publ_btn,function(){

        //数据ID
        var data_id  = cell_value($(this).attr("rowIndex"),1);

        //远程提交
        $.ajax({
            url     : API.test_response,
            type    : "post",
            dataType: "json",
            data    : { id : data_id },
            success : function(data){
                if( data.code>0 ){
                    um_tip(data.message);
                    um_reset(personnel_train_exam_datagrid_obj,personnel_train_exam_api.datagrid);
                } else {
                    um_tip(data.message,"1500","text-danger");
                }
            }
        });

    });

    //删除按钮-----------------------------------------------------------------------------------------------
    $(document).on("click",personnel_train_exam_dele_btn,function(){

        //数据ID
        var data_id = cell_value($(this).attr("rowIndex"),1);

        //其他操作
        personnel_train_exam_dele_submit.attr("dataId",data_id);                                //ID传值
        personnel_train_exam_dele_box.modal("show");                                            //面板显示

    });
    //删除提交
    personnel_train_exam_dele_submit.click(function(){

        //数据ID
        var data_id = $(this).attr("dataId");

        //远程提交
        $.ajax({
            url     : API.test_response,
            type    : "post",
            dataType: "json",
            data    : { id:data_id },
            success : function(data){
                if( data.code>0 ){
                    um_tip(data.message);
                    um_reset(personnel_train_exam_datagrid_obj,personnel_train_exam_api.datagrid);
                } else {
                    um_tip(data.message,"1500","text-danger");
                }
            }
        });

    });


});//预加载结尾
</script>