<!-- 页面外套 -->
<div class="page-wrapper" id="design_list">

	<!-- 数据网格 -->
	<div class="datagrid datagrid-striped" id="design_list_datagrid">

		<!-- 工具条组 -->
		<div class="tool-group">
			<div class="tool-search">
				<div class="im-label">
					<div class="input-group">
						<select class="form-control" id="design_list_tool_keys">
							<option value="1">项目编号</option>
							<option value="2">项目名称</option>
							<option value="4">商务专员</option>
							<option value="4">设计师</option>
						</select>
						<span class="input-group-addon fix-border fix-padding"></span>
						<input type="text" class="form-control" id="design_list_tool_search">
					</div>
				</div>
				<label><span>项目状态：</span><select class="form-control" id="design_list_tool_select1">
						<!--JS推进--></select></label>
				<label><span>房源状态：</span><select class="form-control" id="design_list_tool_select2">
						<!--JS推进--></select></label>
				<label><span>洽谈级别：</span><select class="form-control" id="design_list_tool_select3">
						<!--JS推进--></select></label>
				<label><button class="btn btn-primary" id="design_list_search_btn"><i class="icon icon-search"></i> 查询</button></label>
				<div class="clearfix"></div>
			</div>
		</div>
		<!-- tool-group -->
		<div class="datagrid-container"></div>
		<ul class="pager btn-mini" data-elements="prev,pages,next"></ul>
	</div>
	<!-- datagrid -->
<!--洽谈等级盒子 -->
	<div class="modal modal-for-page fade" aria-hidden="false" id="design_list_great_box">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">关闭</span></button>
					<h4 class="modal-title">洽谈等级</h4>
				</div>
				<div class="modal-body">
					<form class="container form-horizontal">
						<div class="form-group require">
							<label class="col-sm-2 required" for="design_list_great_level">洽谈等级</label>
							<div class="col-sm-8"><select class="form-control" id="design_list_great_level"><!--JS推进--></select></div>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
					<button type="button" class="btn btn-primary" id="design_list_great_submit">提交</button>
				</div>
			</div>
		</div>
	</div>
	<!--design_list_great_box -->
	<div class="modal modal-for-page fade" aria-hidden="false" id="design_list_progress_btn">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">关闭</span></button>
					<h4 class="modal-title">设计进度</h4>
				</div>
				<div class="modal-body">
					<form class="container form-horizontal">
						<div class="form-group">
							<label class="col-sm-2 required" for="design_list_progress_btn">设计进度</label>
							<div class="col-sm-8">
								<select class="form-control" id="design_list_progress_btn">
									<!--JS推进--></select>
							</div>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
					<button type="button" class="btn btn-primary" id="design_list_level_submit">提交</button>
				</div>
			</div>
		</div>
	</div>
	<!--design_list_progress_btn -->
	<!-- 回访记录盒子 -->
	<div class="modal modal-for-page fade" aria-hidden="false" id="design_list_logAdd_box">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">关闭</span></button>
					<h4 class="modal-title">添加回访记录</h4>
				</div>
				<div class="modal-body">
					<form class="container form-horizontal">
						<div class="form-group">
							<label class="col-sm-2 required" for="design_list_logAdd_text">日志内容</label>
							<div class="col-sm-8"><textarea class="form-control" id="design_list_logAdd_text"></textarea></div>
						</div>
						<div class="form-group">
							<label class="col-sm-2 required" for="design_list_logAdd_text">对手进展</label>
							<div class="col-sm-8">
									<div class="col">
										<div class="opt">
											<input class="magic-radio" type="radio" name="radio1" id="r1" value="1">
											<label for="r1" class="r1"><span>无</span></label>
										</div>
										<div class="opt">
											<input class="magic-radio" type="radio" name="radio1" id="r2" value="2" checked>
											<label for="r2" class="r2">方案</label>
										</div>
										<div class="opt">
											<input class="magic-radio" type="radio" name="radio1" id="r3" value="3" checked>
											<label for="r3" class="r3">效果图</label>
										</div>
										<div class="opt">
											<input class="magic-radio" type="radio" name="radio1" id="r4" value="4" checked>
											<label for="r4" class="r4">报价</label>
										</div>
										<div class="opt">
											<input class="magic-radio" type="radio" name="radio1" id="r5" value="5" checked>
											<label for="r4" class="r5">合同</label>
										</div>
									</div>
							</div>
                            </div>
							<div class="form-group">
								<label class="col-sm-2 required" for="design_list_follow_up">跟进情况</label>
								<div class="col-sm-8"><textarea class="form-control" id="design_list_follow_up"></textarea></div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 required" for="design_list_difficulty">现阶段困难</label>
								<div class="col-sm-8"><textarea class="form-control" id="design_list_difficulty"></textarea></div>
							</div>
							<div class="form-group">
								<label class="col-sm-2" for="design_list_external">外协情况</label>
								    <div class="col-sm-8">
										<div class="col">
											<div class="opt">
												<input class="magic-radio" type="radio" name="radio2" id="w1" value="1">
												<label for="w1" class="r1"><span>无</span></label>
											</div>
											<div class="opt">
												<input class="magic-radio" type="radio" name="radio2" id="w2" value="2" checked>
												<label for="w2" class="r2">空调</label>
											</div>
											<div class="opt">
												<input class="magic-radio" type="radio" name="radio2" id="w3" value="3" checked>
												<label for="w3" class="r3">消防</label>
											</div>
											<div class="opt">
												<input class="magic-radio" type="radio" name="radio2" id="w4" value="4" checked>
												<label for="w4" class="r4">家具</label>
											</div>
											<div class="opt">
												<input class="magic-radio" type="radio" name="radio2" id="w5" value="5" checked>
												<label for="w4" class="r5">弱电</label>
											</div>
										</div>
								  </div>
							    </div>
							<div class="form-group">
								<label class="col-sm-2 for="design_list_estimate">预估单值</label>
								<div class="col-sm-8"><input type="text" name="inp" id="design_list_estimate" class="form-control"/></div>
							</div>
							  <div class="form-group">
							      <label class="col-sm-2" for="design_list_cycle">回访周期</label>
							      <div class="col-sm-8">
							          <select class="form-control" id="design_list_cycle"><!-- JS推进 --></select>
							      </div>
							  </div>
						     <div class="form-group">
						       <label class="col-sm-2" for="design_list_visit">下次回访</label>
						         <div class="col-sm-8">
						           <select class="form-control" id="design_list_visit"><!-- JS推进 --></select>
						         </div>
						     </div> 
							
							
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
					<button type="button" class="btn btn-primary" id="design_list_logAdd_submit">提交</button>
				</div>
			</div>
		</div>
	</div>
	<!--design_list_logAdd_box -->
	<!-- 项目查看盒子 -->
	<div class="modal modal-for-page fade" aria-hidden="false" id="design_list_show_box">
	    <div class="modal-dialog modal-fullscreen">
	        <div class="modal-content">
	            <div class="modal-header">
	                <button class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">关闭</span></button>
	                <h4 class="modal-title">项目查看</h4>
	            </div>
	            <div class="modal-body modal-scroll">
	                <div class="container">
	
	                    <!-- 项目进度 -->
	                    <table class="table table-bordered" id="design_list_show_t_prog">
	                        <thead><tr><th>项目进度</th></tr></thead>
	                        <tbody><!-- JS推进 --></tbody>
	                    </table>
	
	                    <!-- 项目信息 -->
	                    <table class="table table-bordered" id="design_list_show_t_case">
	                        <thead><tr><th colspan="2">项目信息
	                            <button class="btn btn-default btn-mini pull-right um_btn_collapse"><i class="icon icon-angle-up"></i></button>
	                        </th></tr></thead>
	                        <tbody><!-- JS推进 --></tbody>
	                    </table>
	
	                    <!-- 负责人信息 -->
	                    <table class="table table-bordered" id="design_list_show_t_user">
	                        <thead><tr><th colspan="2">负责人信息
	                            <button class="btn btn-default btn-mini pull-right um_btn_collapse"><i class="icon icon-angle-up"></i></button>
	                        </th></tr></thead>
	                        <tbody><!-- JS推进 --></tbody>
	                    </table>
	
	                    <!-- 切换面板 -->
	                    <ul class="nav nav-tabs">
	                        <li class="active"><a data-tab="" href="#design_list_show_filelist">客户附件</a></li>
	                        <li><a data-tab="" href="#design_list_show_record">操作记录</a></li>
	                    </ul>
	                    <div class="tab-content">
	                        <div class="datagrid datagrid-striped tab-pane active" id="design_list_show_filelist">
	                            <!-- 工具条组 -->
	                            <div class="tool-group" style="padding:0;border-top:0">
	                                <div class="tool-deal" style="padding:5px;">
	                                    <div class="btn-group" data-toggle="buttons" id="design_list_show_filelist_type">
	                                        <label class="btn btn-mini active"><input type="radio" name="filetype" value="1">商务附件</label>
	                                        <label class="btn btn-mini"><input type="radio" name="filetype" value="2">设计附件</label>
	                                        <label class="btn btn-mini"><input type="radio" name="filetype" value="3">施工图</label>
	                                        <label class="btn btn-mini"><input type="radio" name="filetype" value="4">效果图</label>
	                                        <label class="btn btn-mini"><input type="radio" name="filetype" value="5">报价附件</label>
	                                        <label class="btn btn-mini"><input type="radio" name="filetype" value="6">合同附件</label>
	                                    </div>
	                                    <div class="clearfix"></div>
	                                </div>
	                            </div>
	                            <!-- tool-group -->
	                            <div class="datagrid-container"></div>
	                            <ul class="pager btn-mini" data-elements="prev,pages,next"></ul>
	                        </div>
	                        <div class="datagrid datagrid-striped tab-pane" id="design_list_show_record">
	                            <div class="datagrid-container"></div>
	                            <ul class="pager btn-mini" data-elements="prev,pages,next"></ul>
	                        </div>
	                    </div>
	                </div>
	            </div>
	        </div>
	    </div>
	</div>
	<!-- design_list_show_box -->
</div>
<!-- page-wrapper -->
<script>
	$(function() {

		//变量声明-----------------------------------------------------------------------------------------------
		var
			design_list = $("#design_list"), //页面ID
			design_list_datagrid = $("#design_list_datagrid"), //数据表格
			//搜索
			design_list_tool_keys = $("#design_list_tool_keys"), //搜索类别
			design_list_tool_search = $("#design_list_tool_search"), //搜索字段
			design_list_search_btn = $("#design_list_search_btn"), //搜索按钮
			design_list_tool_select1 = $("#design_list_tool_select1"), //下拉选项
			design_list_tool_select2 = $("#design_list_tool_select2"), //下拉选项
			design_list_tool_select3 = $("#design_list_tool_select3"), //下拉选项
			//查看
			design_list_show_box = $("#design_list_show_box"), //查看盒子
			design_list_show_t_prog = $("#design_list_show_t_prog"), //项目进度
			design_list_show_t_case = $("#design_list_show_t_case"), //项目信息
			design_list_show_t_user = $("#design_list_show_t_user"), //负责人信息
			design_list_show_filelist = $("#design_list_show_filelist"), //客户附件
			design_list_show_filelist_type = $("#design_list_show_filelist_type"), //客户附件类型
			design_list_show_record = $("#design_list_show_record"), //操作记录
			//分单
			design_list_assign_box          = $("#design_list_assign_box"),           //分单盒子
			design_list_assign_submit       = $("#design_list_assign_submit"),        //分单提交
			design_list_cycle               = $("#design_list_cycle"),          //分单设计师
			//洽谈等级
			design_list_great_box = $("#design_list_great_box"), //洽谈盒子
			design_list_great_submit = $("#design_list_great_submit"), //洽谈提交
			design_list_great_level = $("#design_list_great_level"), //洽谈等级
			//跟踪日志
			design_list_logShow_box = $("#design_list_logShow_box"), //日志查看盒子
			design_list_logAdd_box = $("#design_list_logAdd_box"), //design_list盒子
			design_list_logAdd_submit = $("#design_list_logAdd_submit"), //design_list提交
			design_list_logAdd_text = $("#design_list_logAdd_text"), //design_list内容
			design_list_follow_up   = $("#design_list_follow_up"),  //跟进情况
			design_list_difficulty  = $("#design_list_difficulty"),  //现阶段困难
			design_list_logAdd_file = $("#design_list_logAdd_file"), //design_list附件
			design_list_estimate    =$("#design_list_estimate"),     //预估单值  
			design_list_visit       =$("#design_list_visit"),        //下次回访
			design_list_cycle       =$("#design_list_cycle"),        //回访周期
			design_list_logAdd_date = $("#design_list_logAdd_date"); //添加下次跟踪

		//接口对象-----------------------------------------------------------------------------------------------
		if (window.STATE == "local") {

			//本地接口
			var design_list_api = {
				datagrid: LOCAL + "Test/test_datagrid.json", //数据表格
				datagrid_filelist: LOCAL + "Test/Business/customer_filelist.json", //客户附件表格
				datagrid_record: LOCAL + "Test/test_datagrid.json", //操作记录表格
				modal_show: LOCAL + "Test/Business/customer_edit.json", //查看盒子
				topic: LOCAL + "Test/Business/provider_topic.json", //日志查看
				select: LOCAL + "Test/test_select.json", //下拉选择
				select_level: LOCAL + "Test/Design/admin_level.json", //下拉选择(等级)
			}

		} else if (window.STATE == "route") {

			//远程接口
			var design_list_api = {
				datagrid: LOCAL + "Test/test_datagrid.json", //数据表格
				datagrid_filelist: LOCAL + "Test/Business/customer_filelist.json", //客户附件表格
				datagrid_record: LOCAL + "Test/test_datagrid.json", //操作记录表格
				modal_show: LOCAL + "Test/Business/customer_edit.json", //查看盒子
				topic: LOCAL + "Test/Business/provider_topic.json", //日志查看
				select: LOCAL + "Test/test_select.json", //下拉选择
			}

		}

		//数据表格-----------------------------------------------------------------------------------------------
		design_list_datagrid.datagrid({
			height: zui_datagrid_height(design_list_datagrid),
			sortable: false,
			cache: false,
			showRowIndex: true,
			// checkable   : true,
			// checkByClickRow:false,
			// selectable  : false,
			configs: {
				R0: {
					className: "text-center"
				},
				C1: {
					className: "cell-hidden"
				}
			},
			states: {
				pager: {
					page: 1,
					recPerPage: window.REC_PER_PAGE,
				}
			},
			dataSource: {
				cols: [{
					name: "id",
					label: "ID",
					width: 40
				     },
						{
						name: "date",
						label: "所有状态时间",
						width: 100
					},
					{
						name: "username",
						label: "项目编号",
						width: 100,
						html:true,
						    valueOperator : {
						        getter : function(dataValue,cell){
						            return `<a class="design_list_show_btn" rowIndex="${cell.rowIndex}">${dataValue}</a>`;
						        }
						    }
					},
					{name:"text8",   label:"项目名称",width:150},
					{
						name: "date",
						label: "分单时间",
						width: 160
					},
					
					{
						name: "name",
						label: "联系人1",
						width: 100
					},
					{
						name: "name",
						label: "信息员",
						width: 100
					},
					{
						name: "name",
						label: "业务员",
						width: 100
					},
					{
						name: "name",
						label: "主案设计师",
						width: 100
					},
					{
						name: "text6",
						label: "房源状态",
						width: 100
					},
					{
						name: "level",
						label: "洽谈等级",
						width: 80,
						html: true,
						valueOperator: {
							getter: function(dataValue, cell) {
								var level = "";
								switch (dataValue) {
									case 1:
										level = "A";
										break;
									case 2:
										level = "B";
										break;
									case 3:
										level = "C";
										break;
									case 4:
										level = "D";
										break;
									case 5:
										level = "E";
										break;
									case 6:
										level = "F";
										break;
								}
								return `<a class="design_list_great_btn" rowIndex="${cell.rowIndex}" rowLevel="${dataValue}">${level}</a>
					       `;
							}
						}
					},
					{
						name: "text2",
						label: "面积",
						width: 100
					},
					{
						name: "date",
						label: "上次回访时间",
						width: 100
					},
					{
						name: "tex10",
						label: "上次回访内容",
						width: 150
					},
					{
						name: "state",
						label: "剩余回访天数",
						width: 100
					},
					{
						name: "tex10",
						label: "项目状态",
						width: 150
					},
					{
						name: "log",
						label: "操作",
						width: 80,
						html: true,
						valueOperator: {
							getter: function(dataValue, cell) {
								return `<a class="design_list_logAdd_btn"  rowIndex="${cell.rowIndex}">回访</a>`;
							}
						}
					}
				],
				remote: function() {
					return {
						url: design_list_api.datagrid,
						type: "POST",
						dataType: "json",
					}
				}
			}
		});

		//查看表格-客户附件
		design_list_show_filelist.datagrid({
			height: "page",
			rowDefaultHeight: 72,
			sortable: false,
			cache: false,
			showRowIndex: true,
			configs: {
				R0: {
					className: "text-center"
				},
				C1: {
					className: "cell-hidden"
				},
				C7: {
					className: "text-center"
				},
			},
			states: {
				pager: {
					page: 1,
					recPerPage: 10,
				}
			},
			dataSource: {
				cols: [{
						name: "id",
						label: "ID",
						width: 49
					},
					{
						name: "thumb",
						label: "缩略图",
						width: 70,
						html: true,
						valueOperator: {
							getter: function(dataValue, cell) {
								var file_thumb = "";
								if (dataValue.thumb_icon == "image") {
									file_thumb = `<img src="${dataValue.thumb_path}">`
								} else if (dataValue.thumb_icon == "file") {
									file_thumb = `<i style="font-size:50px!important;" class="icon icon-file-o"></i>`;
								} else {
									file_thumb = `<i style="font-size:50px!important;" class="icon icon-file-${dataValue.thumb_icon}"></i>`;
								}
								return file_thumb;
							}
						}
					},
					{
						name: "name",
						label: "附件名称",
						width: 300
					},
					{
						name: "type",
						label: "类型",
						width: 80
					},
					{
						name: "uploader",
						label: "上传者",
						width: 80
					},
					{
						name: "date",
						label: "上传时间",
						width: 140
					},
					{
						name: "path",
						label: "导出/下载",
						width: 80,
						html: true,
						valueOperator: {
							getter: function(dataValue, cell) {
								return `<a target="_blank" href="${dataValue}"><i class="icon icon-download-alt"></i></a>`;
							}
						}
					}
				],
				remote: function() {
					return {
						url: design_list_api.datagrid_filelist,
						type: "POST",
						dataType: "json",
					}
				}
			}
		});
		//查看表格-操作记录
		design_list_show_record.datagrid({
			height: "page",
			sortable: false,
			cache: false,
			showRowIndex: true,
			configs: {
				R0: {
					className: "text-center"
				},
				C1: {
					className: "cell-hidden"
				}
			},
			states: {
				pager: {
					page: 1,
					recPerPage: window.REC_PER_PAGE,
				}
			},
			dataSource: {
				cols: [{
						name: "id",
						label: "ID",
						width: 49
					},
					{
						name: "name",
						label: "操作人",
						width: 80
					},
					{
						name: "object",
						label: "日志",
						width: 240,
						html: true,
						valueOperator: {
							getter: function(dataValue, cell, datagrid) {
								var temp = "";
								if (dataValue.state == 1) {
									temp = `<span class="text-danger">${dataValue.text}</span>`;
								} else {
									temp = `<span class="text-success">${dataValue.text}</span>`;
								}
								return temp;
							}
						}
					},
					{
						name: "date",
						label: "时间",
						width: 140
					},
				],
				remote: function() {
					return {
						url: design_list_api.datagrid_record,
						type: "POST",
						dataType: "json",
					}
				}
			}
		});

		//变量声明-----------------------------------------------------------------------------------------------
		var
			design_list_datagrid_obj = design_list_datagrid.data("zui.datagrid"), //表格对象
			design_list_show_filelist_obj = design_list_show_filelist.data("zui.datagrid"), //查看表格1
			design_list_show_record_obj = design_list_show_record.data("zui.datagrid"), //查看表格2	
			design_list_level_btn = ".design_list_level_btn", //级别按钮
			design_list_show_btn  = ".design_list_show_btn",    //查看按钮
			design_list_logAdd_btn = ".design_list_logAdd_btn"; //回访按钮
			design_list_great_btn = ".design_list_great_btn"; //洽谈等级按钮
			
		    

		//上传创建-----------------------------------------------------------------------------------------------
		zui_upload_group({
			upid: "design_list_logAdd_file",
			type: "img",
			maxSize: "10mb"
		});

		//下拉选项-----------------------------------------------------------------------------------------------
		//洽谈级别-工具条组
		$.ajax({
			url: design_list_api.select,
			type: "post",
			dataType: "json",
			data: {},
			success: function(data) {
				if (data.status > 0) {
					var data = data.data;
					var option = "<option value='0'>全部</option>";
					for (var i = 0; i < data.length; i++) {
						option += "<option value='" + data[i].id + "'>" + data[i].name + "</option>"
					}
					design_list_tool_select1.html(option);
					design_list_tool_select2.html(option);
					design_list_tool_select3.html(option);
				}
			}
		});
		//洽谈级别-工具条组
		$.ajax({
			url: design_list_api.select,
			type: "post",
			dataType: "json",
			data: {},
			success: function(data) {
				if (data.status > 0) {
					var data = data.data;
					var option = "";
					for (var i = 0; i < data.length; i++) {
						option += "<option value='" + data[i].id + "'>" + data[i].name + "</option>"
					}
					design_list_cycle.html(option);
					design_list_visit.html(option);
				  
				}
			}
		});
		$.ajax({
			url: design_list_api.select_level,
			type: "post",
			dataType: "json",
			data: {},
			success: function(data) {
				if (data.status > 0) {
					var data = data.data;
					var option = "";
					for (var i = 0; i < data.length; i++) {
						option += "<option value='" + data[i].id + "'>" + data[i].name + "</option>"
					}
					design_list_great_level.html(option);
		
				}
			}
		});
		//日志时间
		$.ajax({
			url: design_list_api.select,
			type: "post",
			dataType: "json",
			data: {},
			success: function(data) {
				if (data.status > 0) {
					var data = data.data;
					var option = "";
					for (var i = 0; i < data.length; i++) {
						option += "<option value='" + data[i].id + "'>" + data[i].name + "</option>"
					}
					   design_list_logAdd_date.html(option);
				}
			}
		});

		//搜索按钮-----------------------------------------------------------------------------------------------
		design_list_search_btn.click(function() {

			//字段整理
			var keyword = "?sid=" + design_list_tool_keys.val() +
				"&search=" + design_list_tool_search.val() +
				"&select1=" + design_list_tool_select1.val() +
				"&select2=" + design_list_tool_select2.val() +
				"&select3=" + design_list_tool_select3.val()

			//GET提交
			zui_datagrid_render(design_list_datagrid_obj, design_list_api.datagrid + keyword);

		});

		//客户附件筛选
		design_list_show_filelist_type.find(".btn").click(function() {

			//字段整理
			var keyword = "?id=" + design_list_show_filelist_type.attr("rowIndex") +
				"&type=" + $(this).find("input").val();

			zui_datagrid_render(design_list_show_filelist_obj, design_list_api.datagrid_filelist + keyword);
		});
		//洽谈等级-----------------------------------------------------------------------------------------
		$(document).on("click",design_list_great_btn, function() {
		
			//数据取值
			var data_id = $(this).attr("rowIndex");
			var rowLevel = $(this).attr("rowLevel");
		
			//数据赋值
			design_list_great_submit.attr("dataId", data_id);
			design_list_great_level.val(rowLevel);
		
			//面板显示
			design_list_great_box.modal("show");
		
		});
		//洽谈等级-提交
		design_list_great_submit.click(function() {
			//数据ID
			var data_id = $(this).attr("dataId");
			//远程提交
			$.ajax({
				url: API.test_response,
				type: "post",
				dataType: "json",
				data: {
					id: data_id,
					level:design_list_great_level.val()
				},
				success: function(data) {
					if (data.status > 0) {
						um_tip(data.message);
						zui_datagrid_reset(design_list_datagrid_obj,design_list_api.datagrid);
		
					} else {
						um_tip(data.message, "1500", "text-danger");
						console.log(data.message)
					}
				}
			});
		
		});
          //查看按钮-----------------------------------------------------------------------------------------------
          $(document).on("click",design_list_show_btn,function(){ 
          
              //数据ID
              var data_id  = zui_datagrid_get_id($(this).attr("rowIndex"));
          
              //远程提交
              $.ajax({
                  url     : design_list_api.modal_show,
                  type    : "post",
                  dataType: "json",
                  data    : { id:data_id },
                  success : function(data){
                      if( data.status>0 ){
          
                          //查看模板
                          var data = data.data;
          
                          //项目进度
                          var temp_prog = `<tr><td><ul class="bussiness-prog-group flex-box">`;
                          var temp_prog_state_class = "bg-primary";
                          for( var i=0;i<data.prog.length;i++){
                              if( data.prog[i].state==0 ){ temp_prog_state_class = "bg-grey" }
                              temp_prog +=`
                                  <li class="flex-son text-center">
                                      <b class="${temp_prog_state_class}">${i+1}</b>
                                      <div class="small">${data.prog[i].name}</div>
                                      <div class="small">${data.prog[i].date}</div>
                                  </li>
                              `;
                          }
                          design_list_show_t_prog.find("tbody").html(temp_prog+"</ul></td></tr>");
          
                          //项目信息
                          var temp_case = `
                              <tr><td style="width:120px;">项目编号</td><td>${data.number}</td></tr>
                              <tr><td>项目名称  </td><td>${data.case}         </td></tr>
                              <tr><td>项目状态  </td><td>${data.state}        </td></tr>
                              <tr><td>申请理由  </td><td>${data.reason}       </td></tr>
                              <tr><td>装修面积  </td><td>${data.decoarea} ㎡  </td></tr>
                              <tr><td>房源状态  </td><td>${data.statename}    </td></tr>
                              <tr><td>装修地址  </td><td>${data.decoaddr}     </td></tr>
                              <tr><td>联系人1   </td><td>${data.user1}        </td></tr>
                              <tr><td>手机1     </td><td>${data.tel1}         </td></tr>
                              <tr><td>联系人2   </td><td>${data.user2}        </td></tr>
                              <tr><td>手机2     </td><td>${data.tel2}         </td></tr>
                              <tr><td>办公地址  </td><td>${data.addr}         </td></tr>
                              <tr><td>办公电话  </td><td>${data.tel0}         </td></tr>
                              <tr><td>信息员    </td><td>${data.providername} </td></tr>
                              <tr><td>房屋类型  </td><td>${data.housetypename}</td></tr>
                              <tr><td>装修意向  </td><td>${data.housetodoname}</td></tr>
                              <tr><td>装修服务  </td><td>${data.houseservname}</td></tr>
                              <tr><td>交房日期  </td><td>${data.housedate1}   </td></tr>
                              <tr><td>期望完工  </td><td>${data.housedate2}   </td></tr>
                              <tr><td>对手数量  </td><td>${data.rivalnumb}    </td></tr>
                              <tr><td>对手进展  </td><td>${data.rivalstepname}</td></tr>
                              <tr><td>备注      </td><td>${data.text}         </td></tr>
                          `;
                          design_list_show_t_case.find("tbody").html(temp_case);
          
                          //负责人信息
                          var temp_user = `
                              <tr><td style="width:120px;">业务员</td><td>${data.salesman}</td></tr>
                              <tr><td>设计师      </td><td>${data.designer}   </td></tr>
                              <tr><td>效果图绘图员</td><td>${data.sketcher}   </td></tr>
                              <tr><td>施工图绘图员</td><td>${data.draftsman}  </td></tr>
                              <tr><td>预算员      </td><td>${data.budgetor}   </td></tr>
                              <tr><td>工程监理    </td><td>${data.supervision}</td></tr>
                              <tr><td>项目经理    </td><td>${data.manager}    </td></tr>
                          `;
                          design_list_show_t_user.find("tbody").html(temp_user);
                          
                          //数据表格
                          zui_datagrid_render(design_list_show_filelist_obj,design_list_api.datagrid_filelist+"?id="+data_id+"&type=1");
                          zui_datagrid_render(design_list_show_record_obj,design_list_api.datagrid_record+"?id="+data_id);
                          
                          design_list_show_filelist_type.attr("rowIndex",data_id);      //ID赋值
                          design_list_show_box.modal("show");                           //盒子显示
                      } else {
                          um_tip(data.message,"1500","text-danger");
                      }
                  }
              });
          
          });
		 

	}); //预加载结尾
</script>
<style>
	/* 单选框样式更改 */
	keyframes hover-color {
		from {
			border-color: #c0c0c0;
		}

		to {
			border-color: #3e97eb;
		}
	}

	.col {
		display: flex;
	}

	.opt {
		margin-left: 4px;
	}

	.r1,
	.r2,.r3,
	.r4,
	.r5 {
		margin-top: 9px;
	}
	.magic-radio,
	.magic-checkbox {
		position: absolute;
		display: none;
	}

	.magic-radio[disabled],
	.magic-checkbox[disabled] {
		cursor: not-allowed;
	}

	.magic-radio+label,
	.magic-checkbox+label {
		position: relative;
		display: block;
		padding-left: 30px;
		cursor: pointer;
		vertical-align: middle;
	}

	.magic-radio+label:hover:before,
	.magic-checkbox+label:hover:before {
		animation-duration: 0.4s;
		animation-fill-mode: both;
		animation-name: hover-color;
	}
     /* 圆点样式修改 */
	.magic-radio+label:before,
	.magic-checkbox+label:before {
		position: absolute;
		top: 0;
		left: 0;
		/* display: inline-block; */
		width: 12px;
		height: 12px;
		content: '';
		border: 1px solid #c0c0c0;
	    margin-top: 4px;
		 margin-left: 10px
	}

	.magic-radio+label:after,
	.magic-checkbox+label:after {
		position: absolute;
		display: none;
		content: '';
	}

	.magic-radio[disabled]+label,
	.magic-checkbox[disabled]+label {
		cursor: not-allowed;
		color: #e4e4e4;
	}

	.magic-radio[disabled]+label:hover,
	.magic-radio[disabled]+label:before,
	.magic-radio[disabled]+label:after,
	.magic-checkbox[disabled]+label:hover,
	.magic-checkbox[disabled]+label:before,
	.magic-checkbox[disabled]+label:after {
		cursor: not-allowed;
	}

	.magic-radio[disabled]+label:hover:before,
	.magic-checkbox[disabled]+label:hover:before {
		border: 1px solid #e4e4e4;
		animation-name: none;
	}

	.magic-radio[disabled]+label:before,
	.magic-checkbox[disabled]+label:before {
		border-color: #e4e4e4;
	}

	.magic-radio:checked+label:before,
	.magic-checkbox:checked+label:before {
		animation-name: none;
	}

	.magic-radio:checked+label:after,
	.magic-checkbox:checked+label:after {
		display: block;
	}

	.magic-radio+label:before {
		border-radius: 50%;
	}

	/* 点击之后的圆点样式更改 */
	.magic-radio+label:after {
		top: 7px;
		left: 13px;
		width: 6px;
		height: 6px;
		border-radius: 50%;
		background: #d2e6fb;
	}

	/* 圆点边框样式更改 */
	.magic-radio:checked+label:before {
		border: 1px solid #d2e6fb;
	}

	.magic-radio:checked[disabled]+label:before {
		border: 1px solid #c9e2f9;
	}

	.magic-radio:checked[disabled]+label:after {
		background: #d2e6fb;
	}

	.magic-checkbox+label:before {
		border-radius: 3px;
	}

	.magic-checkbox+label:after {
		top: 2px;
		left: 7px;
		box-sizing: border-box;
		width: 6px;
		height: 12px;
		transform: rotate(45deg);
		border-width: 2px;
		border-style: solid;
		border-color: #fff;
		border-top: 0;
		border-left: 0;
	}

	.magic-checkbox:checked+label:before {
		border: #3e97eb;
		background: #3e97eb;
	}

	.magic-checkbox:checked[disabled]+label:before {
		border: #c9e2f9;
		background: #c9e2f9;
	}
</style>
